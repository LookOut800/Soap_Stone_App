"use strict";function homeController(){}function loginController(a,b){var c=this;c.login=function(d){a.login(d).then(function(a){c.credentials={},b.path("/")})}}function navbarController(a,b){var c=this;c.isLoggedin=function(){return a.isAuthenticated()},c.logout=function(){a.logout().then(function(){b.path("/")})}}function postsController(a){var b=this;b.posts=a.posts}function cooperHewittController(a,b,c){var d=this;d.artObjects=a.artObjects,c.artObject={title:"",period:"",color:"",medium:"",type:""},c.search=function(b){console.log("lets search:",b),a.searchObjects(b)},d.saveItem=function(a){console.log("grabbing item:",a),b.upsertArtObject(a)}}function artObjectController(a,b){function c(a){var b="";return angular.forEach(a,function(a,c){b+=c+": "+a}),b}function d(){a.setArtObject({name:"",period:"",medium:"",type:""}),e.serverErrors=!1}var e=this;e.artObjects=a.artObjects,b.$on("$viewContentLoaded",function(){console.log("lets get your art objects"),a.getArtObejcts()}),e.getArtObejcts=function(){console.log("lets get your art objects"),a.getArtObejcts()},e.upsertArtObject=function(b){a.upsertArtObject(b).then(function(){d()},function(a){e.serverErrors=!0,e.serverErrorMsg=c(a.data)})},e.cancel=function(){d()}}function timelinesController(a,b){var c=this;c.timelines=a.timelines,b.timeline={title:"",description:""},b.$on("$viewContentLoaded",function(){a.getTimelines(),console.log("gotTimelines on load")}),b.getTimelines=function(){console.log("lets get your timelines"),a.getTimelines()},c.upsertTimeline=function(b){a.upsertTimeline(b).then(function(){resetForm()},function(a){})},c.activateTimeline=function(b){a.activateTimeline(b),console.log("Activated:",b)},c.cancel=function(){resetForm()},c.handleErrors=function(a){var b="";return angular.forEach(a,function(a,c){b+=c+": "+a}),b},c.resetForm=function(){a.setTimeline({title:"",description:""}),c.serverErrors=!1}}angular.module("soapStoneApp",["ngAnimate","ngAria","ngCookies","ngMessages","ngResource","ngRoute","ngSanitize","ngTouch","MainController","MainDirective"]).run(["$rootScope","$http","$window","$location","AuthFactory","PostsFactory","CooperHewittFactory","ArtObjectFactory","TimelinesFactory",function(a,b,c,d,e,f,g,h,i){if(e.isAuthenticated()){JSON.parse(c.localStorage.getItem("ss-user"))}else d.path("/login");a.$on("$routeChangeStart",function(a,b){e.isAuthenticated()?i.getTimelines():d.path("/login")})}]),angular.module("soapStoneApp").config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/home.html",controller:"HomeController"}).when("/login",{templateUrl:"views/login.html"}).when("/posts",{templateUrl:"views/posts.html",controller:"PostsController",controllerAs:"postsController"}).when("/art",{templateUrl:"views/art-object.html",controller:"CooperHewittController",controllerAs:"cooperHewittController"}).when("/timelines",{templateUrl:"views/timeline.html",controller:"TimelinesController",controllerAs:"timelinesController"}).when("/timeline-show",{templateUrl:"views/timeline-show.html",controller:"ArtObjectController",controllerAs:"artObjectController"}).otherwise({redirectTo:"/"})}]),angular.module("soapStoneApp").constant("ServerUrl","http://powerful-everglades-6110.herokuapp.com").constant("CooperHewittUrl","https://api.collection.cooperhewitt.org/rest/?method=").constant("CooperApiAccess","bed285fe62e08707962a655f145ab02b"),angular.module("soapStoneApp").factory("AuthFactory",["$http","$window","ServerUrl",function(a,b,c){var d=function(b){return console.log(b),a.post(c+"/login",b).success(function(a){h(a)})},e=function(){return console.log(),a.get(c+"/logout").success(function(){b.localStorage.removeItem("ss-user")})},f=function(){var a=JSON.parse(b.localStorage.getItem("ss-user"));return a?!!a.token:!1},g=function(){},h=function(a){b.localStorage.setItem("ss-user",JSON.stringify(a))};return{login:d,logout:e,isAuthenticated:f,clearStorage:g}}]),angular.module("soapStoneApp").factory("PostsFactory",["$http","$window","ServerUrl",function(a,b,c){var d=[],e=function(){{var e=JSON.parse(b.localStorage.getItem("ss-user"));({headers:{AUTHORZATION:"Token token="+e.token}})}return a.get(c+"/posts").success(function(a){angular.copy(a,d)}).error(function(a,b,c,d){console.log("Youre doing it wrong:",a,b,c,d)})};return{posts:d,getPosts:e}}]),angular.module("soapStoneApp").factory("CooperHewittFactory",["$http","$window","CooperHewittUrl","CooperApiAccess",function(a,b,c,d){var e,f=[],g=function(b){return e=h(b),f=[],a.get(c+"cooperhewitt.search.objects&access_token="+d+e+"&has_image=YES&page=1&per_page=100").success(function(a){i(a),console.log(e,a,status,f)}).error(function(a){console.log("Youre doing it wrong:",a)})},h=function(a){return"&color="+a.color+"&medium="+a.medium+"&period="+a.period+"&title="+a.title+"&type="+a.type},i=function(a){a.objects.forEach(function(a){f.push(a)})},j=function(){return a.get(c+"cooperhewitt.objects.getRandom&access_token="+d+"&has_image=YES").success(function(a){f.push(a),console.log("Random Thing:",a,status)}).error(function(a){console.log("Youre doing it wrong:",a)})};return{searchObjects:g,getRandomObject:j,artObjects:f}}]),angular.module("soapStoneApp").factory("ArtObjectFactory",["$http","$window","ServerUrl",function(a,b,c){var d=[],e={},f=function(){var e=JSON.parse(b.localStorage.getItem("ss-user")),f=JSON.parse(b.localStorage.getItem("ss-user-timeline"));return a.get(c+"/users/"+e.id+"/timelines/"+f+"/art_objects").success(function(a){angular.copy(a,d)}).error(function(a,b){console.log("Youre doing it wrong:",a,b)})},g=function(e){var f=(JSON.parse(b.localStorage.getItem("ss-user")),JSON.parse(b.localStorage.getItem("ss-user-timeline"))),g={art_object:{date:e.date,medium:e.medium,title:e.title,object_type:e.type,object_id:e.id,description:e.description,thumbnail:e.images[0].n.url,feature_image:e.images[0].b.url,timeline_id:f}};return a.post(c+"/art_objects",g).success(function(a){d.push(a),console.log("Successful Post:",a,status)}).error(function(a){console.log("Youre doing it wrong:",a)})};return{artObject:e,artObjects:d,getArtObejcts:f,upsertArtObject:g}}]),angular.module("soapStoneApp").factory("TimelinesFactory",["$http","$window","ServerUrl",function(a,b,c){var d=[],e={},f=JSON.parse(localStorage.getItem("ss-user")),g=function(a){angular.copy(a,e)},h=function(){return a.get(c+"/users/"+f.id+"/timelines").then(function(a){angular.copy(a.data,d)})},i=function(a){b.localStorage.setItem("ss-user-timeline",a.id)},j=function(b){b.user_id=f.id;var d={timeline:b};return a.post(c+"/timelines",d)},k=function(b){return a["delete"](c+"/users/"+f.id+"/timelines/"+b.id).then(function(a){d.splice(l(b.id),1)})},l=function(a){for(var b=0;b<d.length;b++)if(d[b].id===a)return b};return{timeline:e,timelines:d,setTimeline:g,getTimelines:h,activateTimeline:i,upsertTimeline:j,deleteTimeline:k}}]),angular.module("MainController",[]),angular.module("MainController").controller("HomeController",homeController),homeController.$inject=[],angular.module("MainController").controller("LoginController",loginController),loginController.$inject=["AuthFactory","$location"],angular.module("MainController").controller("NavbarController",navbarController),navbarController.$inject=["AuthFactory","$location"],angular.module("MainController").controller("PostsController",postsController),postsController.$inject=["PostsFactory"],angular.module("MainController").controller("CooperHewittController",cooperHewittController),cooperHewittController.$inject=["CooperHewittFactory","ArtObjectFactory","$scope"],angular.module("MainController").controller("ArtObjectController",artObjectController),artObjectController.$inject=["ArtObjectFactory","$scope"],angular.module("MainController").controller("TimelinesController",timelinesController),timelinesController.$inject=["TimelinesFactory","$scope"],angular.module("MainDirective",[]),angular.module("MainDirective").directive("loginForm",[function(){return{restrict:"E",templateUrl:"views/login-form.html",controller:"LoginController",controllerAs:"loginController",bindToController:!0,scope:{credentials:"="}}}]),angular.module("MainDirective").directive("ssNavbar",[function(){return{restict:"E",templateUrl:"views/navbar.html",controller:"NavbarController",controllerAs:"navbarController",bindToController:!0,scope:{},link:function(a,b,c){}}}]),angular.module("MainDirective").directive("artForm",[function(){return{restrict:"E",templateUrl:"views/art-search-form.html",controller:"CooperHewittController",controllerAs:"cooperHewittController",bindToController:!0,scope:{credentials:"="}}}]),angular.module("MainDirective").directive("artObject",[function(){return{restrict:"E",templateUrl:"views/art-object-list.html",controller:"CooperHewittController",controllerAs:"cooperHewittController",bindToController:!0,scope:{credentials:"="}}}]),angular.module("MainDirective").directive("activeTimelines",[function(){return{restrict:"E",templateUrl:"views/active-timelines.html",controller:"TimelinesController",controllerAs:"timelinesController",bindToController:!0,scope:{credentials:"="}}}]),angular.module("MainDirective").directive("ssTimelines",[function(){return{restrict:"E",templateUrl:"views/timeline.html",controller:"TimelinesController",controllerAs:"timelinesController",bindToController:!0,scope:{credentials:"="}}}]);